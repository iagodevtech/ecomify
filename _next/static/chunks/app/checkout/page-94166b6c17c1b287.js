(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{65753:function(e,r,s){Promise.resolve().then(s.bind(s,25118))},25118:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return v}});var t=s(57437),a=s(2265),n=s(60429),d=s(99376),i=s(88226),o=s(33388),c=s(48736),l=s(91804),p=s(22252),x=s(83774),m=s(30401),b=s(32660),u=s(37875),h=s(81586),y=s(12381),g=s(49472),j=s(51475),f=s(66960),N=s(27648);function v(){var e,r;let s=(0,d.useRouter)(),{items:v,subtotal:w,shipping:k,discount:C,total:A}=(0,j.jD)(),{loading:E,error:P,processPayment:S}=function(){let[e,r]=(0,a.useState)(!1),[s,t]=(0,a.useState)(null),{items:n,subtotal:d,shipping:i,discount:o,total:c,clearCart:l}=(0,j.jD)(),{createOrder:p}=(0,j.yi)(),{user:x}=(0,j.aC)(),m=async(e,r)=>{try{let s=await fetch("/api/payments/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e,amount:c,currency:"brl",paymentMethod:"card",cardData:r})}),t=await s.json();if(!s.ok)return{success:!1,error:t.error||"Erro no processamento do cart\xe3o"};let a=await fetch("/api/payments/confirm-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:t.paymentIntentId,orderId:e})}),n=await a.json();if(!a.ok)return{success:!1,error:n.error||"Erro na confirma\xe7\xe3o do pagamento"};return{success:!0,orderId:e,paymentIntentId:t.paymentIntentId}}catch(e){return{success:!1,error:"Erro no processamento do cart\xe3o"}}},b=async e=>{try{let r=await fetch("/api/payments/pix",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e,amount:c,currency:"brl"})}),s=await r.json();if(!r.ok)return{success:!1,error:s.error||"Erro no processamento do PIX"};return{success:!0,orderId:e,redirectUrl:s.pixUrl}}catch(e){return{success:!1,error:"Erro no processamento do PIX"}}},u=async e=>{try{let r=await fetch("/api/payments/boleto",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e,amount:c,currency:"brl"})}),s=await r.json();if(!r.ok)return{success:!1,error:s.error||"Erro no processamento do boleto"};return{success:!0,orderId:e,redirectUrl:s.boletoUrl}}catch(e){return{success:!1,error:"Erro no processamento do boleto"}}},h=async e=>{try{let r=await fetch("/api/payments/paypal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e,amount:c,currency:"brl"})}),s=await r.json();if(!r.ok)return{success:!1,error:s.error||"Erro no processamento do PayPal"};return{success:!0,orderId:e,redirectUrl:s.paypalUrl}}catch(e){return{success:!1,error:"Erro no processamento do PayPal"}}};return{loading:e,error:s,processPayment:async e=>{if(!x)return{success:!1,error:"Usu\xe1rio n\xe3o autenticado"};if(0===n.length)return{success:!1,error:"Carrinho vazio"};try{let s;r(!0),t(null);let a={user_id:x.id,status:"pending",payment_status:"pending",payment_method:e.paymentMethod,subtotal:d,shipping:i,discount:o,total:c,shipping_address:e.shippingAddress,billing_address:e.billingAddress,items:n.map(e=>({product_id:e.product_id,name:e.name,price:e.price,quantity:e.quantity,image:e.image,brand:e.brand}))},y=await p(a);if(!y.success||!y.order)return{success:!1,error:y.error||"Erro ao criar pedido"};switch(e.paymentMethod){case"card":s=await m(y.order.id,e.cardData);break;case"pix":s=await b(y.order.id);break;case"boleto":s=await u(y.order.id);break;case"paypal":s=await h(y.order.id);break;default:return{success:!1,error:"M\xe9todo de pagamento n\xe3o suportado"}}return s.success&&l(),s}catch(r){let e=r instanceof Error?r.message:"Erro no processamento do pagamento";return t(e),{success:!1,error:e}}finally{r(!1)}}}}(),[D,T]=(0,a.useState)("address"),[z,O]=(0,a.useState)("card"),[_,I]=(0,a.useState)({shippingAddress:{name:"",street:"",city:"",state:"",zip:"",country:"Brasil"},billingAddress:{name:"",street:"",city:"",state:"",zip:"",country:"Brasil"},cardData:{number:"",expiry:"",cvc:"",name:""},useSameAddress:!0}),M=[{id:"card",name:"Cart\xe3o de Cr\xe9dito",icon:i.Z,description:"Visa, Mastercard, Elo"},{id:"pix",name:"PIX",icon:o.Z,description:"Pagamento instant\xe2neo"},{id:"boleto",name:"Boleto Banc\xe1rio",icon:c.Z,description:"Vencimento em 3 dias"},{id:"paypal",name:"PayPal",icon:l.Z,description:"Pague com sua conta PayPal"}],U=(e,r,s)=>{I(t=>({...t,[e]:{...t[e],[r]:s}}))},Z=async()=>{T("processing");let e={paymentMethod:z,cardData:"card"===z?_.cardData:void 0,shippingAddress:_.shippingAddress,billingAddress:_.useSameAddress?_.shippingAddress:_.billingAddress},r=await S(e);r.success?r.redirectUrl?window.location.href=r.redirectUrl:s.push("/pedido/".concat(r.orderId)):T("review")};return 0===v.length?(0,t.jsx)(g.i,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-dark-900",children:[(0,t.jsx)(u.h,{}),(0,t.jsx)("div",{className:"pt-24 pb-16 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.Z,{className:"w-16 h-16 text-cyber-500 mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Carrinho Vazio"}),(0,t.jsx)("p",{className:"text-cyber-400 mb-6",children:"Adicione produtos ao carrinho antes de finalizar a compra"}),(0,t.jsx)(y.z,{asChild:!0,className:"cyber-button bg-gradient-to-r from-neon-blue to-neon-purple text-white",children:(0,t.jsx)(N.default,{href:"/",children:"Continuar Comprando"})})]})}),(0,t.jsx)(h.$,{})]})}):(0,t.jsx)(g.i,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-dark-900",children:[(0,t.jsx)(u.h,{}),(0,t.jsx)("section",{className:"pt-24 pb-8 bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900",children:(0,t.jsx)("div",{className:"container mx-auto px-4",children:(0,t.jsx)("div",{className:"flex items-center justify-center space-x-8",children:[{id:"address",label:"Endere\xe7o",icon:x.Z},{id:"payment",label:"Pagamento",icon:i.Z},{id:"review",label:"Revis\xe3o",icon:m.Z}].map((e,r)=>{let s=D===e.id,a=["address","payment","review"].indexOf(D)>r;return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full border-2 ".concat(s||a?"border-neon-blue bg-neon-blue text-white":"border-cyber-500 text-cyber-500"),children:(0,t.jsx)(e.icon,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium ".concat(s||a?"text-neon-blue":"text-cyber-500"),children:e.label}),r<2&&(0,t.jsx)("div",{className:"w-8 h-0.5 mx-4 ".concat(a?"bg-neon-blue":"bg-cyber-500")})]},e.id)})})})}),(0,t.jsx)("div",{className:"container mx-auto px-4 pb-16",children:(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2",children:["address"===D&&(0,t.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Endere\xe7o de Entrega"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Nome Completo"}),(0,t.jsx)("input",{type:"text",value:_.shippingAddress.name,onChange:e=>U("shippingAddress","name",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"Seu nome completo"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Endere\xe7o"}),(0,t.jsx)("input",{type:"text",value:_.shippingAddress.street,onChange:e=>U("shippingAddress","street",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"Rua, n\xfamero, complemento"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Cidade"}),(0,t.jsx)("input",{type:"text",value:_.shippingAddress.city,onChange:e=>U("shippingAddress","city",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"Cidade"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Estado"}),(0,t.jsx)("input",{type:"text",value:_.shippingAddress.state,onChange:e=>U("shippingAddress","state",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"Estado"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"CEP"}),(0,t.jsx)("input",{type:"text",value:_.shippingAddress.zip,onChange:e=>U("shippingAddress","zip",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"00000-000"})]})]})]}),"payment"===D&&(0,t.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"M\xe9todo de Pagamento"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:M.map(e=>(0,t.jsx)("button",{onClick:()=>O(e.id),className:"p-4 rounded-lg border-2 transition-all ".concat(z===e.id?"border-neon-blue bg-neon-blue/10":"border-cyber-500/30 hover:border-cyber-500/50"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(e.icon,{className:"w-6 h-6 ".concat(z===e.id?"text-neon-blue":"text-cyber-400")}),(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsx)("div",{className:"font-medium ".concat(z===e.id?"text-neon-blue":"text-white"),children:e.name}),(0,t.jsx)("div",{className:"text-cyber-400 text-sm",children:e.description})]})]})},e.id))})]}),"card"===z&&(0,t.jsxs)("div",{className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Dados do Cart\xe3o"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"N\xfamero do Cart\xe3o"}),(0,t.jsx)("input",{type:"text",value:_.cardData.number,onChange:e=>U("cardData","number",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"0000 0000 0000 0000"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Validade"}),(0,t.jsx)("input",{type:"text",value:_.cardData.expiry,onChange:e=>U("cardData","expiry",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"MM/AA"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"CVV"}),(0,t.jsx)("input",{type:"text",value:_.cardData.cvc,onChange:e=>U("cardData","cvc",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"000"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-cyber-300 text-sm mb-2",children:"Nome no Cart\xe3o"}),(0,t.jsx)("input",{type:"text",value:_.cardData.name,onChange:e=>U("cardData","name",e.target.value),className:"w-full px-4 py-3 bg-dark-700 border border-cyber-500/30 rounded-lg text-white focus:border-neon-blue focus:outline-none",placeholder:"Nome como est\xe1 no cart\xe3o"})]})]})]})]}),"review"===D&&(0,t.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Revisar Pedido"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"Endere\xe7o de Entrega"}),(0,t.jsxs)("div",{className:"bg-dark-700/50 rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-white",children:_.shippingAddress.name}),(0,t.jsx)("p",{className:"text-cyber-300",children:_.shippingAddress.street}),(0,t.jsxs)("p",{className:"text-cyber-300",children:[_.shippingAddress.city,", ",_.shippingAddress.state," ",_.shippingAddress.zip]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"M\xe9todo de Pagamento"}),(0,t.jsxs)("div",{className:"bg-dark-700/50 rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-white",children:null===(e=M.find(e=>e.id===z))||void 0===e?void 0:e.name}),(0,t.jsx)("p",{className:"text-cyber-300",children:null===(r=M.find(e=>e.id===z))||void 0===r?void 0:r.description})]})]})]})]}),"processing"===D&&(0,t.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6 text-center",children:[(0,t.jsx)("div",{className:"animate-spin w-12 h-12 border-2 border-neon-blue border-t-transparent rounded-full mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Processando Pagamento"}),(0,t.jsx)("p",{className:"text-cyber-300",children:"Aguarde enquanto processamos seu pagamento..."})]}),"processing"!==D&&(0,t.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,t.jsxs)(y.z,{onClick:()=>{"payment"===D?T("address"):"review"===D&&T("payment")},variant:"outline",className:"border-cyber-500 text-cyber-400 hover:border-neon-blue hover:text-neon-blue",disabled:"address"===D,children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Voltar"]}),"review"===D?(0,t.jsx)(y.z,{onClick:Z,disabled:E,className:"cyber-button bg-gradient-to-r from-neon-green to-neon-blue text-white",children:E?"Processando...":"Finalizar Pedido"}):(0,t.jsx)(y.z,{onClick:()=>{"address"===D?T("payment"):"payment"===D&&T("review")},className:"cyber-button bg-gradient-to-r from-neon-blue to-neon-purple text-white",children:"Continuar"})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-dark-800/50 border border-cyber-500/30 rounded-xl p-6 sticky top-24",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-6",children:"Resumo do Pedido"}),(0,t.jsx)("div",{className:"space-y-4 mb-6",children:v.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-cover rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-white text-sm font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-cyber-400 text-xs",children:["Qtd: ",e.quantity]})]}),(0,t.jsx)("p",{className:"text-neon-green font-semibold",children:(0,f.T4)(e.price*e.quantity)})]},e.id))}),(0,t.jsxs)("div",{className:"space-y-2 border-t border-cyber-500/30 pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-cyber-300",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsx)("span",{children:(0,f.T4)(w)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-cyber-300",children:[(0,t.jsx)("span",{children:"Frete"}),(0,t.jsx)("span",{children:0===k?"Gr\xe1tis":(0,f.T4)(k)})]}),C>0&&(0,t.jsxs)("div",{className:"flex justify-between text-neon-green",children:[(0,t.jsx)("span",{children:"Desconto"}),(0,t.jsxs)("span",{children:["-",(0,f.T4)(C)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-white font-bold text-lg border-t border-cyber-500/30 pt-2",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsx)("span",{children:(0,f.T4)(A)})]})]})]})})]})}),(0,t.jsx)(h.$,{})]})})}}},function(e){e.O(0,[216,592,744],function(){return e(e.s=65753)}),_N_E=e.O()}]);